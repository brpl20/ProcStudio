- Test {{ }}, << >>;
- Test with Old Contracts
- Check if solution is viable
- Git Pull Request

  üîç Issue Analysis: Text Run Splitting in DOCX Processing

  Ruby-Docx Repository Findings

  ‚úÖ CONFIRMED: This is a well-known, documented issue

  Issue #147: "Text Replacement not working as Expected"
  - Exact same problem: Placeholders like {{vorname}} split into ['{{', 'v', 'orname', '}}']
  - Root cause: Word internally fragments text across multiple <w:r> (text run) nodes
  - Impact: Standard substitute() method fails because it only works on individual runs

  Community Solutions Found

  Several workarounds have been developed:

  1. Regex-based merging: Detect split placeholders and merge runs
  2. Paragraph-level processing: Override paragraph initialization to merge fragmented text
  3. XML preprocessing: Manual template preparation to avoid splits

  Related Libraries

  The search also revealed other Ruby libraries addressing this exact issue:
  - ruby-docx-templater: Built specifically to handle template substitution more reliably
  - docx_replace: Another gem focused on find/replace in DOCX files
  - caracal: Creates DOCX files from scratch to avoid parsing issues

  Nokogiri Repository

  ‚ùå No related issues found - This is not a Nokogiri problem but rather:
  - A Microsoft Word behavior where it internally structures text inconsistently
  - A DOCX format limitation where visual text doesn't match XML structure

  üìä Assessment

  Our EnhancedContractProcessor solution is actually superior to most existing approaches because:

  1. ‚úÖ Universal delimiter support (not hardcoded to specific patterns)
  2. ‚úÖ Paragraph-level processing (more reliable than run-level)
  3. ‚úÖ Preserves formatting (unlike some workarounds that lose styling)
  4. ‚úÖ Production-tested (handles edge cases like tables)

  Industry Status

  This is a common industry problem with DOCX processing in any language (not just Ruby). The issue exists because:
  - Word optimizes internal XML for performance/features, not programmatic access
  - Grammar checkers, spell checkers, and formatting can split text unexpectedly
  - No official Microsoft API guidance for reliable template processing

  Our solution represents current best practices for production DOCX template processing! üéØ
